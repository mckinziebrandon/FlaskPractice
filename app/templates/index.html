{% extends "base.html" %}
<!-- app/templates/index.html:
    * Inherits from base.html.
-->
<!-- Inserts this within the block named 'content' in base.html. -->

{% block page_content %}

  <div class="jumbotron">
    <h1>Look, I know Flask</h1>
    <p>I can do things with computers. This is good for me.</p>
  </div>

  <div class="row">
    <div class="col-sm-12">
      <h2>Users</h2>
      <p>Below is a list of all users stored in the database. Click a user's name
        to see all of their logged posts.</p>
      {% for user in users if user.posts.count() %}
        <!-- Greet user -->
        <div class="panel panel-primary">

          <div class="panel-heading" data-toggle="collapse"
               href="#{{ user.nickname|capitalize }}-posts" aria-expanded="false">
            {{ user.nickname|capitalize }}
          </div>

          <!-- Post list for the given user. -->
          <div id="{{ user.nickname|capitalize }}-posts" class="panel-body collapse">
            <ul class="list-group">
              {%  for post in user.posts %}
                <div class="row">
                  <div class="col-sm-9">
                    <!-- Post body -->
                    <li class="list-group-item justify-content-between">
                      {{ post.body }}
                      <!-- Timestamp on the right. -->
                      <span class="badge badge-default badge-pill">
                        {{ moment(post.timestamp).fromNow(refresh=True) }}
                      </span>
                  </div>

                  <div class="col-sm-1">
                    <!-- Delete button -->
                    <form action="{{ url_for('delete_post', post_id=post.id) }}" method="POST">
                      <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                  </div>
                </div>
              {%  endfor %}
            </ul>
          </div>

        </div>
      {% endfor %}
    </div>
  </div>
{%  endblock page_content %}

